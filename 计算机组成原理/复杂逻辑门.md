# 复杂逻辑门

## 复习

1. 了解了计算机使用二进制（0和1）表示所有数据
2. 掌握了基础逻辑门：与门（AND）、或门（OR）和非门（NOT）
3. 知道了 nand 和 nor 门的函数完备性，它们可以构建其他所有逻辑门

## TL;DR

　　本章介绍由基本逻辑门组合而成的复杂逻辑门，包括异或门、多路选择器和移位器等。这些复杂逻辑门为后续的算术运算（如加法器）提供基础。

## 正文

### 为什么需要复杂逻辑门？

　　在上一章中，我们学习了基本逻辑门（与门、或门、非门）。但仅仅使用这些基本逻辑门，很难高效地完成复杂的运算。就像搭建乐高模型，虽然所有模型都可以用最基本的积木搭建，但使用一些预制的复杂部件会让搭建更加方便。

　　复杂逻辑门就是由基本逻辑门组合而成的更高级的电路单元，它们能够完成更复杂的逻辑运算。这些复杂逻辑门可以大大简化电路设计，提高设计效率。

### 异或门（XOR）

　　异或门（XOR，eXclusive OR的缩写）是最常用的复杂逻辑门之一。它的特点是：当两个输入不同时输出1，相同时输出0。

　　生活中的例子：
- 电灯的双控开关：两个开关的状态不同时灯亮，相同时灯灭
- 过马路的红绿灯：行人和车辆不能同时通行，必须一方通行时另一方等待

　　异或门的真值表：

| 输入 A | 输入 B | 输出 |
| :----: | :----: | :--: |
|   0    |   0    |  0   |
|   0    |   1    |  1   |
|   1    |   0    |  1   |
|   1    |   1    |  0   |

　　异或门可以用基本逻辑门组合实现。从真值表可以看出，异或门的输出在以下两种情况为1：
1. A=0且B=1
2. A=1且B=0

　　这可以用与门、或门和非门组合实现：
1. 用与门和非门检测A=0且B=1的情况
2. 用与门和非门检测A=1且B=0的情况
3. 用或门将这两种情况合并

### 多路选择器（MUX）

　　多路选择器就像是一个数字版的"多选一"开关。它有多个数据输入端，一个选择输入端，和一个输出端。选择输入决定将哪个数据输入传送到输出端。

　　生活中的例子：
- 电视遥控器：通过按键选择不同的频道
- 自动售货机：通过按键选择不同的饮料
- 公交车的报站器：根据位置选择播放不同的站名

　　二选一多路选择器的真值表：

| 选择 S | 输入 A | 输入 B | 输出 |
| :----: | :----: | :----: | :--: |
|   0    |   0    |   0    |  0   |
|   0    |   0    |   1    |  0   |
|   0    |   1    |   0    |  1   |
|   0    |   1    |   1    |  1   |
|   1    |   0    |   0    |  0   |
|   1    |   0    |   1    |  1   |
|   1    |   1    |   0    |  0   |
|   1    |   1    |   1    |  1   |

　　多路选择器在计算机中有广泛应用：
1. 数据选择：从多个数据源中选择一个
2. 指令选择：从多条指令中选择一条执行
3. 地址选择：从多个地址中选择一个访问

### 移位器（Shifter）

　　移位器用于对二进制数进行左移或右移操作。在二进制运算中，左移一位相当于乘以2，右移一位相当于除以2。这是因为在二进制中，每个位的权重是2的幂。

　　生活中的例子：
- 排队时整体向前移动一步
- 计算器上的数字左右移动
- 电子显示屏上的跑马灯效果

　　4位数字左移一位的例子：
- 原数：1011（十进制的11）
- 左移后：0110（十进制的6，最高位1溢出）
- 计算解释：11 × 2 ÷ 2 = 6（因为最高位1溢出）

　　4位数字右移一位的例子：
- 原数：1011（十进制的11）
- 右移后：0101（十进制的5，最低位1丢失）
- 计算解释：11 ÷ 2 = 5.5，去掉小数部分得5

　　移位操作在计算机中有多种应用：
1. 乘除运算：左移实现乘2，右移实现除2
2. 位操作：提取或设置特定的位
3. 数据压缩：通过移位实现简单的数据压缩

### 复杂逻辑门的应用

　　这些复杂逻辑门在计算机中有广泛的应用：

1. 异或门：
   - 用于构建加法器，实现二进制加法
   - 用于数据加密，实现简单的加密算法
   - 用于错误检测，生成校验位

2. 多路选择器：
   - 用于数据选择和路由
   - 用于指令解码
   - 用于内存访问控制

3. 移位器：
   - 用于乘除法运算
   - 用于位操作和数据处理
   - 用于数据对齐

## 补充

　　复杂逻辑门的 CMOS 电路实现：

- 异或门（XOR）

![](https://raw.githubusercontent.com/TinySnow/GithubImageHosting/main/blog/technology/cs-teaching/chapter-3/cmos-xor.png)

- 二选一多路选择器（2-to-1 MUX）

![](https://raw.githubusercontent.com/TinySnow/GithubImageHosting/main/blog/technology/cs-teaching/chapter-3/cmos-mux.png)

## 思考题

1. 为什么说异或门是构建加法器的基础？提示：思考两个二进制位相加的所有可能情况。
2. 一个8选1多路选择器需要多少个选择输入端？为什么？
3. 对一个8位二进制数左移3位，相当于乘以多少？

## 小结

1. 复杂逻辑门是由基本逻辑门组合而成的
2. 异或门在两个输入不同时输出1，是构建加法器的基础
3. 多路选择器实现数据选择，移位器实现位移操作
4. 这些复杂逻辑门为计算机的算术运算提供基础

### 参考资料

1. [Wikipedia(zh)：异或门](https://zh.wikipedia.org/wiki/异或门)
2. [Wikipedia(zh)：多路复用器](https://zh.wikipedia.org/wiki/多路复用器)
3. 《编码：隐匿在计算机软硬件背后的语言》第12章：二进制加法
4. 《计算机组成与设计：硬件/软件接口》第4章：处理器
5. [Wikipedia(zh)：CMOS](https://zh.wikipedia.org/wiki/CMOS)：现代集成电路的主要制造工艺

### 思考题答案（仅供参考）

1. 异或门的输出恰好对应二进制加法的结果位：
   - 0+0=0（异或输出0）
   - 0+1=1（异或输出1）
   - 1+0=1（异或输出1）
   - 1+1=0（异或输出0，需要进位1）

2. 8选1多路选择器需要3个选择输入端：
   - 因为2³=8，3个二进制位正好可以表示8种选择
   - 一般地，2ⁿ选1需要n个选择输入端

3. 左移3位相当于乘以2³=8：
   - 每左移一位相当于乘以2
   - 左移n位相当于乘以2ⁿ
   - 所以左移3位相当于乘以2³=8

## 协议

　　本作品采用[知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)进行许可。
